/*!
 * AjaxUpload - Upload button for uploading multiple files with progress-bar
 * Version: 1.5.7
 * Build date: 2019-05-16
 */

!function(u,e,t,i){var s="ajaxUpload",n={debug:!1,uploadAction:"",uid:"",dragText:"Drop files here to upload",uploadButtonText:"Upload a file",cancelButtonText:"Cancel",failUploadText:"Upload failed",deleteText:"Delete a file",clearText:"Delete all files",hideShowDropArea:!0,thumbX:"100",thumbY:"100",allowedExtensions:[],sizeLimit:0,maxFiles:3,messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."}};function a(e,t){this.options=u.extend({},n,t),this._defaults=n,this._name=s,this.$el=u(e),this.count=0,this.init()}a.prototype={init:function(){var p=this,d=u(".file-uploader-items",p.$el);p.count=d.children().length;new qq.FileUploader({element:u(".file-uploader-buttons",p.$el)[0],action:p.options.uploadAction,params:{uid:p.options.uid,action:"web/upload"},dragText:p.options.dragText,uploadButtonText:p.options.uploadButtonText,cancelButtonText:p.options.cancelButtonText,failUploadText:p.options.failUploadText,hideShowDropArea:!0,allowedExtensions:p.options.allowedExtensions,sizeLimit:p.options.sizeLimit,maxConnections:this.options.maxConnections,messages:p.options.messages,onComplete:function(e,t,n){var o=n.fileid;if(n.success){var i=u("<div>").addClass("file-wrap").data("fileid",o),s=u("<div>").addClass("delete-button").html(p.options.deleteText).click(function(){p.remove(i,o)}),a=u("<input>").attr({name:p.options.uid+"_fileid[]",value:o,type:"hidden"}),r=u("<img>").attr({src:n.filename}).css({position:"relative"}).addClass("thumb");0<p.options.thumbX&&r.css("width",p.options.thumbX+"px"),0<p.options.thumbY&&r.css("height",p.options.thumbY+"px");var l=u("<span>").addClass("title").text(n.originalName);d.append(i.append(a,r,l,s)),u(".qq-upload-list li",p.$el).eq(e).hide(),p.options.debug&&console.log("ID:"+e+"\nResponse:"+JSON.stringify(n))}}});u(".file-uploader-items .file-wrap .delete-button",p.$el).click(function(){var e=u(this).parent(),t=e.data("fileid");p.remove(e,t)});var e=u("<div>").addClass("qq-clear-button").html(p.options.clearText).click(function(){p.clear()});1<p.options.maxFiles&&u(".qq-upload-button",p.$el).after(e).after(" ")},remove:function(t,n){var o=this;u.get(o.options.uploadAction,{delete:n,uid:o.options.uid,action:"web/upload"},function(e){e.success&&(t.fadeOut(function(){u(this).remove()}),o.options.debug&&console.log(JSON.stringify(e)+"\nFile "+n+" deleted."))},"json")},clear:function(){var t=this;u.get(t.options.uploadAction,{delete:"all",uid:t.options.uid,action:"web/upload"},function(e){e.success&&(u(".file-uploader-items",t.$el).empty(),u(".qq-upload-list li",t.$el).remove(),t.options.debug&&console.log(JSON.stringify(e)+"\nAll Items deleted."))},"json")}},u.fn[s]=function(t){var n,o=arguments;return t===i||"object"==typeof t?this.each(function(){u.data(this,"plugin_"+s)||u.data(this,"plugin_"+s,new a(this,t))}):"string"==typeof t&&"_"!==t[0]&&"init"!==t?(this.each(function(){var e=u.data(this,"plugin_"+s);e instanceof a&&"function"==typeof e[t]&&(n=e[t].apply(e,Array.prototype.slice.call(o,1))),"destroy"===t&&u.data(this,"plugin_"+s,null)}),n!==i?n:this):void 0}}(jQuery,window,document);var qq=qq||{};qq.extend=function(e,t){for(var n in t)e[n]=t[n]},qq.indexOf=function(e,t,n){if(e.indexOf)return e.indexOf(t,n);n=n||0;var o=e.length;for(n<0&&(n+=o);n<o;n++)if(n in e&&e[n]===t)return n;return-1},qq.getUniqueId=function(){var e=0;return function(){return e++}}(),qq.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")},qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")},qq.firefox=function(){return-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor},qq.windows=function(){return"Win32"===navigator.platform},qq.attach=function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),function(){qq.detach(e,t,n)}},qq.detach=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n)},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.insertBefore=function(e,t){t.parentNode.insertBefore(e,t)},qq.remove=function(e){e.parentNode.removeChild(e)},qq.contains=function(e,t){return e===t||(e.contains?e.contains(t):!!(8&t.compareDocumentPosition(e)))},qq.toElement=function(){var n=document.createElement("div");return function(e){n.innerHTML=e;var t=n.firstChild;return n.removeChild(t),t}}(),qq.css=function(e,t){null!==t.opacity&&"string"!=typeof e.style.opacity&&void 0!==e.filters&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t)},qq.hasClass=function(e,t){return new RegExp("(^| )"+t+"( |$)").test(e.className)},qq.addClass=function(e,t){qq.hasClass(e,t)||(e.className+=" "+t)},qq.removeClass=function(e,t){var n=new RegExp("(^| )"+t+"( |$)");e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,"")},qq.setText=function(e,t){e.innerText=t,e.textContent=t},qq.children=function(e){for(var t=[],n=e.firstChild;n;)1===n.nodeType&&t.push(n),n=n.nextSibling;return t},qq.getByClass=function(e,t){if(e.querySelectorAll)return e.querySelectorAll("."+t);for(var n=[],o=e.getElementsByTagName("*"),i=o.length,s=0;s<i;s++)qq.hasClass(o[s],t)&&n.push(o[s]);return n},qq.obj2url=function(e,o,t){function n(e,t){var n=o?/\[\]$/.test(o)?o:o+"["+t+"]":t;"undefined"!==n&&"undefined"!==t&&i.push("object"==typeof e?qq.obj2url(e,n,!0):"[object Function]"===Object.prototype.toString.call(e)?encodeURIComponent(n)+"="+encodeURIComponent(e()):encodeURIComponent(n)+"="+encodeURIComponent(e))}var i=[],s="&";if(!t&&o)s=/\?/.test(o)?/\?$/.test(o)?"":"&":"?",i.push(o),i.push(qq.obj2url(e));else if("[object Array]"===Object.prototype.toString.call(e)&&void 0!==e)for(var a=0,r=e.length;a<r;++a)n(e[a],a);else if(null!=e&&"object"==typeof e)for(var a in e)n(e[a],a);else i.push(encodeURIComponent(o)+"="+encodeURIComponent(e));return i.join(s).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(e){this._options={debug:!1,action:"/server/upload",params:{},customHeaders:{},button:null,multiple:!0,maxConnections:3,allowedExtensions:[],acceptFiles:null,sizeLimit:0,minSizeLimit:0,abortOnFailure:!0,onSubmit:function(e,t){},onProgress:function(e,t,n,o){},onComplete:function(e,t,n){},onCancel:function(e,t){},onUpload:function(e,t,n){},onError:function(e,t,n){},messages:{typeError:"Unfortunately the file(s) you selected weren't the type we were expecting. Only {extensions} files are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(e){alert(e)},inputName:"qqfile",extraDropzones:[]},qq.extend(this._options,e),qq.extend(this,qq.DisposeSupport),this._filesInProgress=0,this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FileUploaderBasic.prototype={setParams:function(e){this._options.params=e},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(e){var t=this,n=new qq.UploadButton({element:e,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),acceptFiles:this._options.acceptFiles,onChange:function(e){t._onInputChange(e)}});return this.addDisposer(function(){n.dispose()}),n},_createUploadHandler:function(){var e,i=this;return e=qq.UploadHandlerXhr.isSupported()?"UploadHandlerXhr":"UploadHandlerForm",new qq[e]({debug:this._options.debug,action:this._options.action,encoding:this._options.encoding,maxConnections:this._options.maxConnections,customHeaders:this._options.customHeaders,inputName:this._options.inputName,extraDropzones:this._options.extraDropzones,onProgress:function(e,t,n,o){i._onProgress(e,t,n,o),i._options.onProgress(e,t,n,o)},onComplete:function(e,t,n){i._onComplete(e,t,n),i._options.onComplete(e,t,n)},onCancel:function(e,t){i._onCancel(e,t),i._options.onCancel(e,t)},onError:i._options.onError,onUpload:function(e,t,n){i._onUpload(e,t,n),i._options.onUpload(e,t,n)}})},_preventLeaveInProgress:function(){var t=this;this._attach(window,"beforeunload",function(e){if(t._filesInProgress)return(e=e||window.event).returnValue=t._options.messages.onLeave,t._options.messages.onLeave})},_onSubmit:function(){this._filesInProgress++},_onProgress:function(e,t,n,o){},_onComplete:function(e,t,n){this._filesInProgress--,n.error&&this._options.showMessage(n.error)},_onCancel:function(){this._filesInProgress--},_onUpload:function(e,t,n){},_onInputChange:function(e){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(e.files):this._validateFile(e)&&this._uploadFile(e),this._button.reset()},_uploadFileList:function(e){for(var t=[],n=0;n<e.length;n++)if(this._validateFile(e[n]))t.push(e[n]);else if(this._options.abortOnFailure)return;for(n=0;n<t.length;n++)this._uploadFile(t[n])},_uploadFile:function(e){var t=this._handler.add(e),n=this._handler.getName(t);!1!==this._options.onSubmit(t,n)&&(this._onSubmit(t,n),this._handler.upload(t,this._options.params))},_validateFile:function(e){var t,n;return e.value?t=e.value.replace(/.*(\/|\\)/,""):(t=null!==e.fileName&&void 0!==e.fileName?e.fileName:e.name,n=null!==e.fileSize&&void 0!==e.fileSize?e.fileSize:e.size),this._isAllowedExtension(t)?0===n?(this._error("emptyError",t),!1):n&&this._options.sizeLimit&&n>this._options.sizeLimit?(this._error("sizeError",t),!1):!(n&&n<this._options.minSizeLimit)||(this._error("minSizeError",t),!1):(this._error("typeError",t),!1)},_error:function(e,t){var n=this._options.messages[e];function o(e,t){n=n.replace(e,t)}o("{file}",this._formatFileName(t)),o("{extensions}",this._options.allowedExtensions.join(", ")),o("{sizeLimit}",this._formatSize(this._options.sizeLimit)),o("{minSizeLimit}",this._formatSize(this._options.minSizeLimit)),this._options.showMessage(n)},_formatFileName:function(e){return 33<e.length&&(e=e.slice(0,19)+"..."+e.slice(-13)),e},_isAllowedExtension:function(e){var t=-1!==e.indexOf(".")?e.replace(/.*[.]/,"").toLowerCase():"",n=this._options.allowedExtensions;if(!n.length)return!0;for(var o=0;o<n.length;o++)if(n[o].toLowerCase()===t)return!0;return!1},_formatSize:function(e){for(var t=-1;t++,99<(e/=1024););return Math.max(e,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][t]}},qq.FileUploader=function(e){qq.FileUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,dragText:"Drop files here to upload",uploadButtonText:"Upload a file",cancelButtonText:"Cancel",failUploadText:"Upload failed",hideShowDropArea:!0,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>{dragText}</span></div><div class="qq-upload-button">{uploadButtonText}</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-progress-bar"></span><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><span class="qq-upload-failed-text">{failUploadtext}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}}),qq.extend(this._options,e),this._options.template=this._options.template.replace(/\{dragText\}/g,this._options.dragText),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.uploadButtonText),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.cancelButtonText),this._options.fileTemplate=this._options.fileTemplate.replace(/\{failUploadtext\}/g,this._options.failUploadText),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button=this._createUploadButton(this._find(this._element,"button")),this._bindCancelEvent(),this._setupDragDrop()},qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype),qq.extend(qq.FileUploader.prototype,{addExtraDropzone:function(e){this._setupExtraDropzone(e)},removeExtraDropzone:function(e){var t=this._options.extraDropzones;for(var n in t)if(t[n]===e)return this._options.extraDropzones.splice(n,1)},_leaving_document_out:function(e){return(qq.chrome()||qq.safari()&&qq.windows())&&0===e.clientX&&0===e.clientY||qq.firefox()&&!e.relatedTarget},_find:function(e,t){var n=qq.getByClass(e,this._options.classes[t])[0];if(!n)throw new Error("element not found "+t);return n},_setupExtraDropzone:function(e){this._options.extraDropzones.push(e),this._setupDropzone(e)},_setupDropzone:function(t){var n=this,e=new qq.UploadDropZone({element:t,onEnter:function(e){qq.addClass(t,n._classes.dropActive),e.stopPropagation()},onLeave:function(e){},onLeaveNotDescendants:function(){qq.removeClass(t,n._classes.dropActive)},onDrop:function(e){n._options.hideShowDropArea&&(t.style.display="none"),qq.removeClass(t,n._classes.dropActive),n._uploadFileList(e.dataTransfer.files)}});this._dropZone=e,this.addDisposer(function(){e.dispose()}),this._options.hideShowDropArea&&(t.style.display="none")},_setupDragDrop:function(){var t=this._find(this._element,"drop"),n=this;this._options.extraDropzones.push(t);var o,i=this._options.extraDropzones;for(o=0;o<i.length;o++)this._setupDropzone(i[o]);qq.ie()||this._attach(document,"dragenter",function(e){if(n._dropZone._isValidFileDrag(e)&&!qq.hasClass(t,n._classes.dropDisabled))for(t.style.display="block",o=0;o<i.length;o++)i[o].style.display="block"}),this._attach(document,"dragleave",function(e){document.elementFromPoint(e.clientX,e.clientY);if(n._options.hideShowDropArea&&qq.FileUploader.prototype._leaving_document_out(e))for(o=0;o<i.length;o++)i[o].style.display="none"}),qq.attach(document,"drop",function(e){if(n._options.hideShowDropArea)for(o=0;o<i.length;o++)i[o].style.display="none";e.preventDefault()})},_onSubmit:function(e,t){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(e,t)},_onProgress:function(e,t,n,o){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var i,s=this._getItemByFileId(e),a=this._find(s,"size");a.style.display="inline";var r=Math.round(n/o*100);i=n!==o?r+"% from "+this._formatSize(o):this._formatSize(o),this._find(s,"progressBar").style.width=r+"%",qq.setText(a,i)},_onComplete:function(e,t,n){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var o=this._getItemByFileId(e);qq.remove(this._find(o,"cancel")),qq.remove(this._find(o,"spinner")),n.success?qq.addClass(o,this._classes.success):qq.addClass(o,this._classes.fail)},_addToList:function(e,t){var n=qq.toElement(this._options.fileTemplate);n.qqFileId=e;var o=this._find(n,"file");qq.setText(o,this._formatFileName(t)),this._find(n,"size").style.display="none",this._options.multiple||this._clearList(),this._listElement.appendChild(n)},_clearList:function(){this._listElement.innerHTML=""},_getItemByFileId:function(e){for(var t=this._listElement.firstChild;t;){if(t.qqFileId===e)return t;t=t.nextSibling}},_bindCancelEvent:function(){var o=this,e=this._listElement;this._attach(e,"click",function(e){var t=(e=e||window.event).target||e.srcElement;if(qq.hasClass(t,o._classes.cancel)){qq.preventDefault(e);var n=t.parentNode;o._handler.cancel(n.qqFileId),qq.remove(n)}})}}),qq.UploadDropZone=function(e){this._options={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}},qq.extend(this._options,e),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||qq.firefox()&&qq.windows()},_disableDropOutside:function(){qq.UploadDropZone.dropOutsideDisabled||(this._dragover_should_be_canceled?qq.attach(document,"dragover",function(e){e.preventDefault()}):qq.attach(document,"dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var n=this;n._attach(n._element,"dragover",function(e){if(n._isValidFileDrag(e)){var t=qq.ie()?null:e.dataTransfer.effectAllowed;e.dataTransfer.dropEffect="move"===t||"linkMove"===t?"move":"copy",e.stopPropagation(),e.preventDefault()}}),n._attach(n._element,"dragenter",function(e){n._isValidFileDrag(e)&&n._options.onEnter(e)}),n._attach(n._element,"dragleave",function(e){if(n._isValidFileDrag(e)){n._options.onLeave(e);var t=document.elementFromPoint(e.clientX,e.clientY);qq.contains(this,t)||n._options.onLeaveNotDescendants(e)}}),n._attach(n._element,"drop",function(e){n._isValidFileDrag(e)&&(e.preventDefault(),n._options.onDrop(e))})},_isValidFileDrag:function(e){if(qq.ie())return!1;var t=e.dataTransfer,n=qq.safari();return t&&"none"!==t.effectAllowed&&(t.files||!n&&t.types.contains&&t.types.contains("Files"))}},qq.UploadButton=function(e){this._options={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(e){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,e),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq.remove(this._input),qq.removeClass(this._element,this._options.focusClass),this._input=this._createInput()},_createInput:function(){var e=document.createElement("input");this._options.multiple&&e.setAttribute("multiple","multiple"),this._options.acceptFiles&&e.setAttribute("accept",this._options.acceptFiles),e.setAttribute("type","file"),e.setAttribute("name",this._options.name),qq.css(e,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(e);var t=this;return this._attach(e,"change",function(){t._options.onChange(e)}),this._attach(e,"mouseover",function(){qq.addClass(t._element,t._options.hoverClass)}),this._attach(e,"mouseout",function(){qq.removeClass(t._element,t._options.hoverClass)}),this._attach(e,"focus",function(){qq.addClass(t._element,t._options.focusClass)}),this._attach(e,"blur",function(){qq.removeClass(t._element,t._options.focusClass)}),window.attachEvent&&e.setAttribute("tabIndex","-1"),e}},qq.UploadHandlerAbstract=function(e){this._options={debug:!1,action:"/upload.php",maxConnections:999,onProgress:function(e,t,n,o){},onComplete:function(e,t,n){},onCancel:function(e,t){},onUpload:function(e,t,n){}},qq.extend(this._options,e),this._queue=[],this._params=[]},qq.UploadHandlerAbstract.prototype={log:function(e){this._options.debug&&window.console&&console.log("[uploader] "+e)},add:function(e){},upload:function(e,t){var n=this._queue.push(e),o={};qq.extend(o,t),this._params[e]=o,n<=this._options.maxConnections&&this._upload(e,this._params[e])},cancel:function(e){this._cancel(e),this._dequeue(e)},cancelAll:function(){for(var e=0;e<this._queue.length;e++)this._cancel(this._queue[e]);this._queue=[]},getName:function(e){},getSize:function(e){},getQueue:function(){return this._queue},_upload:function(e){},_cancel:function(e){},_dequeue:function(e){var t=qq.indexOf(this._queue,e);this._queue.splice(t,1);var n=this._options.maxConnections;if(this._queue.length>=n&&t<n){var o=this._queue[n-1];this._upload(o,this._params[o])}}},qq.UploadHandlerForm=function(e){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(e){e.setAttribute("name",this._options.inputName);var t="qq-upload-handler-iframe"+qq.getUniqueId();return(this._inputs[t]=e).parentNode&&qq.remove(e),t},getName:function(e){return this._inputs[e].value.replace(/.*(\/|\\)/,"")},_cancel:function(e){this._options.onCancel(e,this.getName(e)),delete this._inputs[e];var t=document.getElementById(e);t&&(t.setAttribute("src","javascript:false;"),qq.remove(t))},_upload:function(t,e){this._options.onUpload(t,this.getName(t),!1);var n=this._inputs[t];if(!n)throw new Error("file with passed id was not added, or already uploaded or cancelled");var o=this.getName(t),i=this._createIframe(t),s=this._createForm(i,e);s.appendChild(n);var a=this;return this._attachLoadEvent(i,function(){a.log("iframe loaded");var e=a._getIframeContentJSON(i);a._options.onComplete(t,o,e),a._dequeue(t),delete a._inputs[t],setTimeout(function(){a._detach_event(),qq.remove(i)},1)}),s.submit(),qq.remove(s),t},_attachLoadEvent:function(e,t){this._detach_event=qq.attach(e,"load",function(){e.parentNode&&(e.contentDocument&&e.contentDocument.body&&"false"===e.contentDocument.body.innerHTML||t())})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response,innerHTML=doc.body.innerHTML;this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+innerHTML),"<pre>"===innerHTML.slice(0,5).toLowerCase()&&"</pre>"===innerHTML.slice(-6).toLowerCase()&&(innerHTML=doc.body.firstChild.firstChild.nodeValue);try{response=eval("("+innerHTML+")")}catch(e){response={}}return response},_createIframe:function(e){var t=qq.toElement('<iframe src="javascript:false;" name="'+e+'" />');return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t},_createForm:function(e,t){var n=qq.toElement('<form method="post" enctype="multipart/form-data"></form>'),o=qq.obj2url(t,this._options.action);return n.setAttribute("action",o),n.setAttribute("target",e.name),n.style.display="none",document.body.appendChild(n),n}}),qq.UploadHandlerXhr=function(e){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){var e=document.createElement("input");return e.type="file","multiple"in e&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&void 0!==(new XMLHttpRequest).upload},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(e){if(!(e instanceof File))throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)");return this._files.push(e)-1},getName:function(e){var t=this._files[e];return null!==t.fileName&&void 0!==t.fileName?t.fileName:t.name},getSize:function(e){var t=this._files[e];return null!==t.fileSize?t.fileSize:t.size},getLoaded:function(e){return this._loaded[e]||0},_upload:function(t,e){this._options.onUpload(t,this.getName(t),!0);var n=this._files[t],o=this.getName(t);this.getSize(t);this._loaded[t]=0;var i=this._xhrs[t]=new XMLHttpRequest,s=this;i.upload.onprogress=function(e){e.lengthComputable&&(s._loaded[t]=e.loaded,s._options.onProgress(t,o,e.loaded,e.total))},i.onreadystatechange=function(){4===i.readyState&&s._onComplete(t,i)},(e=e||{})[this._options.inputName]=o;var a=qq.obj2url(e,this._options.action);if(i.open("POST",a,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("X-File-Name",encodeURIComponent(o)),"multipart"===this._options.encoding){var r=new FormData;r.append(o,n),n=r}else i.setRequestHeader("Content-Type","application/octet-stream"),i.setRequestHeader("X-Mime-Type",n.type);for(var l in this._options.customHeaders)i.setRequestHeader(l,this._options.customHeaders[l]);i.send(n)},_onComplete:function(id,xhr){if(this._files[id]){var name=this.getName(id),size=this.getSize(id);if(this._options.onProgress(id,name,size,size),200===xhr.status){var response;this.log("xhr - server response received"),this.log("responseText = "+xhr.responseText);try{response=eval("("+xhr.responseText+")")}catch(e){response={}}this._options.onComplete(id,name,response)}else this._options.onError(id,name,xhr),this._options.onComplete(id,name,{});this._files[id]=null,this._xhrs[id]=null,this._dequeue(id)}},_cancel:function(e){this._options.onCancel(e,this.getName(e)),this._files[e]=null,this._xhrs[e]&&(this._xhrs[e].abort(),this._xhrs[e]=null)}}),qq.DisposeSupport={_disposers:[],dispose:function(){for(var e;e=this._disposers.shift();)e()},addDisposer:function(e){this._disposers.push(e)},_attach:function(){this.addDisposer(qq.attach.apply(this,arguments))}};